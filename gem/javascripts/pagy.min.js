window.Pagy=(()=>{const P="sessionStorage"in window&&"BroadcastChannel"in window;let $,x,O;if(P)$=sessionStorage,x=new BroadcastChannel("pagy"),O=Date.now(),x.addEventListener("message",(z)=>{if(z.data.from){const G=$.getItem(z.data.key);if(G)x.postMessage({to:z.data.from,key:z.data.key,cutoffs:G})}else if(z.data.to){if(z.data.to==O)$.setItem(z.data.key,z.data.cutoffs)}});const J=new ResizeObserver((z)=>z.forEach((G)=>{G.target.querySelectorAll(".pagy-rjs").forEach((F)=>F.pagyRender())})),U=(z)=>btoa(String.fromCharCode(...new TextEncoder().encode(z))),B=(z)=>z.replace(/=/g,"").replace(/[+/]/g,(G)=>G=="+"?"-":"_"),N=(z)=>B(U(z)),_=(z)=>new TextDecoder().decode(Uint8Array.from(atob(z),(G)=>G.charCodeAt(0))),E=async(z,[G,[F,L]])=>{if(!P)return;let H=document.cookie.split(/;\s+/).find((T)=>T.startsWith("pagy="))?.split("=")[1];if(!H)document.cookie="pagy="+(H=Math.floor(Math.random()*46656).toString(36));if(F&&!(F in $))x.postMessage({from:O,key:F}),await new Promise((T)=>setTimeout(()=>T(""),100));F||="pagy-"+Date.now().toString(36);const Q=$.getItem(F),R=Q?JSON.parse(Q):[void 0];if(L)R.splice(...L),$.setItem(F,JSON.stringify(R));for(let T of z.querySelectorAll("a[href]")){const Z=T.href,M=new RegExp(`(?<=\\?.*)\\b${G}=([\\d]+)`),X=parseInt(Z.match(M)?.[1]),j=N(JSON.stringify([H,F,X,R.length,R[X-1],R[X]]));T.href=Z.replace(M,`${G}=${j}`)}},q=(z,[G,F,L,H])=>{const Q=z.parentElement??z,R=Object.keys(F).map((M)=>parseInt(M)).sort((M,X)=>X-M);let T=-1;const Z=(M,X,j)=>M.replace(/__pagy_page__/g,X).replace(/__pagy_label__/g,j);if((z.pagyRender=()=>{const M=R.find((Y)=>Y<Q.clientWidth)||0;if(M===T)return;let X=G.before;const j=F[M.toString()],A=L?.[M.toString()]??j.map((Y)=>Y.toString());if(j.forEach((Y,I)=>{const C=A[I];let D;if(typeof Y=="number")D=Z(G.a,Y.toString(),C);else if(Y=="gap")D=G.gap;else D=Z(G.current,Y,C);X+=D}),X+=G.after,z.innerHTML="",z.insertAdjacentHTML("afterbegin",X),T=M,H)E(z,H)})(),z.classList.contains("pagy-rjs"))J.observe(Q)},V=(z,[G])=>W(z,(F)=>G.replace(/__pagy_page__/,F)),v=(z,[G,F])=>{W(z,(L)=>{const H=Math.max(Math.ceil(G/parseInt(L)),1).toString();return F.replace(/__pagy_page__/,H).replace(/__pagy_limit__/,L)})},W=(z,G)=>{const F=z.querySelector("input"),L=z.querySelector("a"),H=F.value,Q=()=>{if(F.value===H)return;const[R,T,Z]=[F.min,F.value,F.max].map((M)=>parseInt(M)||0);if(T<R||T>Z){F.value=H,F.select();return}L.href=G(F.value),L.click()};["change","focus"].forEach((R)=>F.addEventListener(R,()=>F.select())),F.addEventListener("focusout",Q),F.addEventListener("keypress",(R)=>{if(R.key=="Enter")Q()})};return{version:"9.3.3",init(z){const G=z instanceof Element?z:document,F=G.querySelectorAll("[data-pagy]");for(let L of F)try{const[H,...Q]=JSON.parse(_(L.getAttribute("data-pagy")));if(H=="nav")E(L,Q);else if(H=="nav_js")q(L,Q);else if(H=="combo_js")V(L,Q);else if(H=="selector_js")v(L,Q)}catch(H){console.warn("Pagy.init() error: %o\n%s",L,H)}}}})();
